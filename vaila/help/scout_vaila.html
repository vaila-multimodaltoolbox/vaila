<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>vailá Scout - Help</title>
  <meta name="description" content="vailá Scout: annotate soccer events and generate heatmaps." />
  <style>
    :root { color-scheme: light dark; }
    body { font-family: Arial, Helvetica, sans-serif; line-height: 1.5; margin: 24px; }
    h1, h2, h3 { color: #222; }
    code, pre { background: #f5f5f5; padding: 2px 4px; border-radius: 4px; }
    pre { padding: 12px; overflow: auto; }
    .kbd { border: 1px solid #ccc; padding: 2px 6px; border-radius: 3px; background: #f9f9f9; }
    ul { margin-top: 0; }
    .topbar { display: flex; justify-content: space-between; align-items: center; gap: 12px; }
    .lang-switch { display: flex; gap: 8px; align-items: center; }
    .lang-switch button { cursor: pointer; padding: 6px 10px; border-radius: 4px; border: 1px solid #888; background: #f7f7f7; }
    .lang-switch button.active { font-weight: bold; background: #e8e8e8; }
    .hidden { display: none; }
    @media (prefers-color-scheme: dark) {
      body { color: #eee; background: #111; }
      h1, h2, h3 { color: #fff; }
      code, pre { background: #222; }
      .kbd { background: #222; border-color: #555; }
      .lang-switch button { background: #1e1e1e; border-color: #555; color: #eee; }
      .lang-switch button.active { background: #333; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <h1>vailá Scout</h1>
    <div class="lang-switch">
      <span>Language:</span>
      <button id="btn-en" class="active" type="button">EN</button>
      <button id="btn-pt" type="button">PT-BR</button>
    </div>
  </div>

  <!-- English -->
  <section id="lang-en">
    <p>The vailá Scout tool lets you annotate soccer events on a virtual field and generate quick analyses (heatmaps).</p>

    <h2>How to Run</h2>
    <pre><code>python vaila.py   # Click the "Scout" button in the vailá GUI
python -m vaila.scout_vaila   # or run the module directly
python vaila/scout_vaila.py   # or run the script file</code></pre>

    <h2>Features</h2>
    <ul>
      <li>Field drawn to scale (default 105 × 68 m).</li>
      <li>Click to annotate events (team, player with optional name, action, result).</li>
      <li>Configurable teams, players, player names, actions, results, and field size via TOML.</li>
      <li>Save/Load events as CSV with action codes and player names.</li>
      <li>Heatmap in a separate window.</li>
      <li>Numeric hotkeys for faster action selection.</li>
      <li>Player rosters displayed side-by-side (Home/Away).</li>
      <li>Automatic per-player summary CSV when saving events.</li>
      <li>Quick team renaming and numeric entry for action codes.</li>
      <li>Action symbols drawn on field by default for better distinction.</li>
      <li>Remove events with Ctrl + right click functionality.</li>
    </ul>

    <h2>CSV Format</h2>
    <pre><code>timestamp_s,team,player_name,player,action,action_code,result,pos_x_m,pos_y_m</code></pre>
    <p><em>Note:</em> <code>player_name</code> and <code>action_code</code> are included when available.</p>

    <h2>Players Summary CSV</h2>
    <pre><code>team,player,num_events,first_timestamp_s,last_timestamp_s,timestamps</code></pre>

    <h2>Configuration (TOML)</h2>
    <p>The app looks for <code>vaila_scout_config.toml</code> next to the script (same folder) or under <code>vaila/models</code>. If none is found, a commented template is created in <code>vaila/models</code>. You can Load/Save or Create Template the config within the app.</p>

    <h3>Template summary</h3>
    <pre><code>[program]
name = "vaila_scout"
version = "0.1.0"
...

[project]
field_width_m = 105.0
field_height_m = 68.0
...

[teams.home]
name = "HOME"
color = "#1f77b4"
players = ["1","2",...,"23"]

[teams.home.players_names]
"10" = "Pelé"  # optional mapping number → name

[teams.away]
name = "AWAY"
color = "#d62728"
players = ["1","2",...,"23"]

[teams.away.players_names]
"10" = "Maradona"

[drawing]
player_circle_radius_m = 0.6
player_edge_color = "black"
player_number_color = "white"
player_number_size = 8
action_symbol_size = 90.0
show_player_name = true
player_name_size = 8
show_action_symbol = true  # draw action symbols on field

results = ["success", "fail", "neutral"]

[[actions]]        # structured actions with codes
name = "Pass"
code = 1
symbol = "o"
key = "p"
color = "#FFD700"

[[actions]]
name = "Shot"
code = 6
symbol = "*"
key = "g"
color = "#FF4500"
...</code></pre>

    <h2>UI</h2>
    <ul>
      <li><strong>Left</strong>: field (click to annotate)</li>
      <li><strong>Right controls</strong>: Action and Result selectors, CSV buttons, Clock (Start/Pause/Reset), Config (Load/Save/Create Template), Quick action code input.</li>
      <li><strong>Right bottom</strong>: Home and Away rosters (No/Name) side by side with team names displayed.</li>
      <li><strong>Heatmap</strong>: opens in a new window when clicking Show Heatmap</li>
    </ul>

    <h2>Hotkeys</h2>
    <ul>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">S</span>: Save CSV</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">O</span>: Load CSV</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">K</span>: Clear events</li>
      <li><span class="kbd">H</span>: Show heatmap</li>
      <li><span class="kbd">R</span>: Reset timer</li>
      <li><span class="kbd">Space</span>: Start/Pause clock</li>
      <li><span class="kbd">?</span>: Open help</li>
      <li><span class="kbd">T</span>: Toggle current team (home/away)</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">L</span>: Load config</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">Shift</span>+<span class="kbd">S</span>: Save config</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">T</span>: Rename teams</li>
      <li>Digits 0–9: Enter action code; <span class="kbd">Enter</span> apply; <span class="kbd">Backspace</span> edit; <span class="kbd">Esc</span> clear</li>
      <li>Mouse: Left click = success, Right click = fail, Middle click = neutral</li>
      <li><span class="kbd">Ctrl</span> + Right click: Remove the most recent event near clicked position (hold Ctrl, right click)</li>
    </ul>

    <h2>Notes</h2>
    <ul>
      <li>Field coordinates are in meters, ranges [0, field_width] × [0, field_height].</li>
      <li>Heatmap uses seaborn KDE.</li>
      <li>Action codes are numeric identifiers for quick input (1-11 by default).</li>
      <li>Player markers show team color with result-based outline (blue=success, red=fail, white=neutral).</li>
      <li>Action symbols are drawn by default next to player circles with enhanced visibility.</li>
      <li>Event removal works within a 1-meter radius and removes only the most recent event.</li>
    </ul>
  </section>

  <!-- Português (BR) -->
  <section id="lang-pt" class="hidden">
    <p>O vailá Scout permite anotar eventos de futebol em um campo virtual e gerar análises rápidas (heatmaps).</p>

    <h2>Como executar</h2>
    <pre><code>python vaila.py   # Clique no botão "Scout" na GUI do vailá
python -m vaila.scout_vaila   # ou execute o módulo diretamente
python vaila/scout_vaila.py   # ou execute o arquivo do script</code></pre>

    <h2>Recursos</h2>
    <ul>
      <li>Campo desenhado em escala (padrão 105 × 68 m).</li>
      <li>Clique para anotar eventos (equipe, jogador com nome opcional, ação, resultado).</li>
      <li>Times, jogadores, nomes, ações, resultados e tamanho do campo configuráveis via TOML.</li>
      <li>Salvar/Carregar eventos em CSV com códigos de ação e nomes de jogadores.</li>
      <li>Heatmap em uma janela separada.</li>
      <li>Atalhos numéricos para seleção rápida de ações.</li>
      <li>Rosters de jogadores exibidos lado a lado (Casa/Fora).</li>
      <li>Geração automática de CSV de resumo por jogador ao salvar.</li>
      <li>Renomeie times rapidamente e use entrada numérica para códigos de ação.</li>
      <li>Símbolos de ação desenhados no campo por padrão para melhor distinção.</li>
      <li>Remover eventos com funcionalidade Ctrl + clique direito.</li>
    </ul>

    <h2>Formato CSV</h2>
    <pre><code>timestamp_s,team,player_name,player,action,action_code,result,pos_x_m,pos_y_m</code></pre>
    <p><em>Nota:</em> <code>player_name</code> e <code>action_code</code> são incluídos quando disponíveis.</p>

    <h2>CSV de resumo por jogador</h2>
    <pre><code>team,player,num_events,first_timestamp_s,last_timestamp_s,timestamps</code></pre>

    <h2>Configuração (TOML)</h2>
    <p>O app procura por <code>vaila_scout_config.toml</code> ao lado do script (mesma pasta) ou sob <code>vaila/models</code>. Se nenhum for encontrado, um template comentado é criado em <code>vaila/models</code>. Você pode Carregar/Salvar ou Criar Template da configuração no app.</p>

    <h3>Esquema padrão</h3>
    <pre><code>[program]
name = "vaila_scout"
version = "0.1.0"
author = "Paulo Roberto Pereira Santiago"
email = "paulosantiago@usp.br"
description = "Scouting integrado (anotação + análise) para futebol."

[project]
name = "vaila_scout"
field_width_m = 105.0
field_height_m = 68.0

[teams.home]
name = "HOME"
color = "#1f77b4"
players = ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
players_names = { "10" = "Pelé", "9" = "Ronaldo" } # opcional

[teams.away]
name = "AWAY"
color = "#d62728"
players = ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
players_names = { "10" = "Maradona" } # opcional

[drawing]
player_circle_radius_m = 0.6
player_edge_color = "black"
player_number_color = "white"
player_number_size = 8
action_symbol_size = 90.0
show_player_name = true
player_name_size = 8
show_action_symbol = true  # desenhar símbolos de ação no campo

results = ["success", "fail", "neutral"]

[[actions]]        # ações estruturadas com códigos
name = "Pass"
code = 1
symbol = "o"
key = "p"
color = "#FFD700"

[[actions]]
name = "Shot"
code = 6
symbol = "*"
key = "g"
color = "#FF4500"
...</code></pre>

    <h2>Interface</h2>
    <ul>
      <li><strong>Esquerda</strong>: campo (clique para anotar)</li>
      <li><strong>Direita (controles)</strong>: seletores de ação e resultado, botões de CSV, relógio (Iniciar/Pausar/Resetar), configuração (Carregar/Salvar/Criar Template), entrada rápida de código de ação.</li>
      <li><strong>Direita (inferior)</strong>: rosters de Casa e Fora (Número/Nome) lado a lado com nomes dos times exibidos.</li>
      <li><strong>Heatmap</strong>: abre em nova janela ao clicar em Show Heatmap</li>
    </ul>

    <h2>Atalhos</h2>
    <ul>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">S</span>: Salvar CSV</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">O</span>: Carregar CSV</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">K</span>: Limpar eventos</li>
      <li><span class="kbd">H</span>: Mostrar heatmap</li>
      <li><span class="kbd">R</span>: Resetar tempo</li>
      <li><span class="kbd">Space</span>: Iniciar/Pausar relógio</li>
      <li><span class="kbd">?</span>: Abrir ajuda</li>
      <li><span class="kbd">T</span>: Alternar equipe atual (casa/fora)</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">L</span>: Carregar configuração</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">Shift</span>+<span class="kbd">S</span>: Salvar configuração</li>
      <li><span class="kbd">Ctrl</span>+<span class="kbd">T</span>: Renomear times</li>
      <li>Dígitos 0–9: digitar código de ação; <span class="kbd">Enter</span> aplica; <span class="kbd">Backspace</span> edita; <span class="kbd">Esc</span> limpa</li>
      <li>Mouse: Clique esquerdo = sucesso, Clique direito = falha, Clique do meio = neutro</li>
      <li><span class="kbd">Ctrl</span> + Clique direito: Remover o evento mais recente próximo à posição clicada (segure Ctrl, clique direito)</li>
    </ul>

    <h2>Notas</h2>
    <ul>
      <li>Coordenadas em metros, faixas [0, field_width] × [0, field_height].</li>
      <li>Heatmap usa KDE do seaborn.</li>
      <li>Códigos de ação são identificadores numéricos para entrada rápida (1-11 por padrão).</li>
      <li>Marcadores de jogadores mostram cor do time com contorno baseado no resultado (azul=sucesso, vermelho=falha, branco=neutro).</li>
      <li>Símbolos de ação são desenhados por padrão ao lado dos círculos dos jogadores com visibilidade aprimorada.</li>
      <li>A remoção de eventos funciona dentro de um raio de 1 metro e remove apenas o evento mais recente.</li>
    </ul>
  </section>

  <script>
    (function () {
      const btnEn = document.getElementById('btn-en');
      const btnPt = document.getElementById('btn-pt');
      const en = document.getElementById('lang-en');
      const pt = document.getElementById('lang-pt');

      function setLang(lang) {
        const isEn = lang === 'en';
        en.classList.toggle('hidden', !isEn);
        pt.classList.toggle('hidden', isEn);
        btnEn.classList.toggle('active', isEn);
        btnPt.classList.toggle('active', !isEn);
        document.documentElement.lang = isEn ? 'en' : 'pt-BR';
        try { localStorage.setItem('vailaHelpLang', lang); } catch (e) {}
      }

      btnEn.addEventListener('click', () => setLang('en'));
      btnPt.addEventListener('click', () => setLang('pt'));

      // initial
      let lang = 'en';
      try {
        const stored = localStorage.getItem('vailaHelpLang');
        if (stored === 'pt' || stored === 'en') lang = stored;
      } catch (e) {}
      setLang(lang);
    })();
  </script>
</body>
</html>